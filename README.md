# Битрикс: Накопительные скидки с учётом текущего заказа

Обработчик формирует новое условие "Сумма выполненных заказов + сумма текущего заказа" в правилах работы с корзиной.
Используется для расчёта накопительных скидок с учётом текущего заказа. Также, в отличии от стандартного условия "Сумма оплаченных заказов", производит расчёт не по оплаченным заказам, а по выполненным. Товары из текущего заказа, к которым уже была применена скида ($basketItem["PRICE"] != $basketItem["BASE_PRICE"]) не учитываются при расчёте суммы текущего заказа в накопительной скидке. Скидки применяются на уровне корзины, на уровне каталога они не видны.

**UPDATE:** Текущий репозиторий был доработан и превращён в модуль [Расширенные накопительные скидки в правилах работы с корзиной](https://marketplace.1c-bitrix.ru/solutions/delight.cumulativediscounts/). А затем на его основе был создан универсальный модуль [PHP-условие в правилах работы с корзиной для реализации собственных условий скидок и наценок](https://marketplace.1c-bitrix.ru/solutions/delight.phpdiscounts/).
